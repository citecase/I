name: Sync Google Doc to gdoc.md
on:
  schedule:
    - cron: '30 16 * * *'
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      # This step installs Pandoc so the runner knows how to use the command
      - name: Install Pandoc
        run: sudo apt-get install -y pandoc

      - name: Download and Convert to gdoc.md
        run: |
          # 1. Download the Doc as HTML
          curl -L "https://docs.google.com/document/d/194RElGx-t_nw8GmW_P4xxOGYlvSFbUJGHGa4Lg3OQ4Y/export?format=html" -o temp_doc.html
          
          # 2. Convert to Markdown and save as gdoc.md
          pandoc temp_doc.html -f html -t gfm --wrap=none -o gdoc.md
          
          # 3. Clean up
          rm temp_doc.html

      - name: Commit and Push changes
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git add gdoc.md
          git commit -m "Auto-update gdoc.md from Google Doc" || exit 0
          git push
